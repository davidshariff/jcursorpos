/**
 * jCursorPos
 * 
 * https://github.com/davidshariff/jCursorPos
 *
 * Copyright (c) 2013 David Shariff
 * http://davidshariff.com/blog/
 *
 * Licensed under the MIT license.
 **/
(function(e,c,a,g){var f={onChange:function(){},className:"jCursorPos"},d={clone:'<pre class="'+f.className+" "+f.className+'-clone"></pre>',clone_cursor:'<span class="'+f.className+" "+f.className+'-cursor"></span>'};function b(i,h){this.$el=e(i);this.$clone={};this.$cursor={};this.options=e.extend({},f,h);this._defaults=f;this.init()}b.prototype={init:function(){var h=this;this.createPluginStyles();this.createClone();this.$el.bind("keyup keydown paste focus mouseup",function(){h.updateCursor();h.updateOrig();h.options.onChange.call(h.$el,h.$cursor)})},calcCursor:function(){var h,i;if(this.$el.width()!==this.$clone.width()||this.$el.height()!==this.$clone.height()){this.cloneStyles()}h=this.$el.offset();i=this.$clone.find("."+f.className+"-cursor").position();return{position:i,offset:{left:(h.left+i.left)-this.$el.scrollLeft(),top:(h.top+i.top)-this.$el.scrollTop()}}},cloneStyles:function(){var h=["font-family","font-size","font-weight","font-style","color","text-transform","text-decoration","letter-spacing","word-spacing","line-height","text-align","vertical-align","direction","background-color","background-image","background-repeat","background-position","background-attachment","opacity","width","height","top","right","bottom","left","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","position","display","visibility","z-index","overflow-x","overflow-y","white-space","clip","float","clear","cursor","list-style-image","list-style-position","list-style-type","marker-offset"],i=this.$el.prop("tagName")==="TEXTAREA"?"break-word":"normal";this.$clone.css(this.$el.css(h)).css({left:"-9999px",position:"absolute","word-wrap":i,"white-space":"pre-wrap"});if(this.$el.get(0).scrollHeight>this.$el.innerHeight()){this.$clone.css("overflow-y","scroll")}if(this.$el.get(0).scrollWidth>this.$el.innerWidth()){this.$clone.css("overflow-x","scroll")}},createClone:function(){this.$clone=e(d.clone).appendTo(e("body"));this.cloneStyles()},createPluginStyles:function(){var h=e("."+f.className+"-styles");if(h.length===0){h=e('<style class="'+f.className+'-styles"></style>').prepend("."+f.className+" br { display: block; }").prepend("."+f.className+"-cursor { display: inline-block; padding: 0; border: 0; }").appendTo("head")}},getCaretPos:function(){var j=this.$el[0],l=0;if("selectionStart" in j){l=j.selectionStart}else{if("selection" in a){j.focus();var i=j.createTextRange(),h=a.selection.createRange().duplicate(),k=h.getBookmark();i.moveToBookmark(k);while(i.moveStart("character",-1)!==0){l++}}}return l},getText:function(){return this.$el[0].contentEditable==="true"?this.$el.html():this.$el.val()},updateCursor:function(){var k=this.getCaretPos(),j=this.getText(),h=j.substring(0,k).replace(/\n/g,"<br>"),i=j.substring(k).replace(/\n/g,"<br>");this.$clone.html(h+d.clone_cursor+i);this.$cursor=this.calcCursor()},updateOrig:function(){this.$el.attr({"data-jcursorpos-offset-left":this.$cursor.offset.left,"data-jcursorpos-offset-top":this.$cursor.offset.top,"data-jcursorpos-position-left":this.$cursor.position.left,"data-jcursorpos-position-top":this.$cursor.position.top})}};e.fn.jCursorPos=function(h){return this.each(function(){if(!e.data(this,"plugin_jCursorPos")){e.data(this,"plugin_jCursorPos",new b(this,h))}})}})(jQuery,window,document);
